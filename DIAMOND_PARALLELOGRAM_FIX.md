# è±å½¢å’Œå¹³è¡Œå››è¾¹å½¢å¡«å……ä¿®å¤

## âŒ é—®é¢˜æè¿°

**é”™è¯¯ç°è±¡ï¼š**
- è±å½¢å’Œå¹³è¡Œå››è¾¹å½¢çš„å¡«å……ä¸æ­£ç¡®
- å¡«å……çš„æ˜¯ä¸€ä¸ªçŸ©å½¢åŒºåŸŸï¼Œè€Œä¸æ˜¯çœŸæ­£çš„å›¾å½¢å†…éƒ¨
- çŸ©å½¢åŒºåŸŸçš„é«˜åº¦ = ä¸Šä¸‹é¡¶ç‚¹çš„å‚ç›´è·ç¦»
- çŸ©å½¢åŒºåŸŸçš„å®½åº¦ = å·¦å³é¡¶ç‚¹çš„æ°´å¹³è·ç¦»

**é”™è¯¯åŸå› ï¼š**
åœ¨ `FillAlgorithms.cpp` ä¸­ï¼ŒDiamond å’Œ Parallelogram ä½¿ç”¨äº†ç®€å•çš„è¾¹ç•Œæ¡†æ£€æŸ¥ï¼š

```cpp
case ShapeType::DIAMOND:
case ShapeType::PARALLELOGRAM:
    // ç®€å•çš„è¾¹ç•Œæ¡†æ£€æŸ¥ï¼ˆé”™è¯¯çš„å®ç°ï¼‰
    return (point.x >= bounds.left && point.x <= bounds.right &&
            point.y >= bounds.top && point.y <= bounds.bottom);
```

è¿™åªæ£€æŸ¥ç‚¹æ˜¯å¦åœ¨è¾¹ç•ŒçŸ©å½¢å†…ï¼Œè€Œä¸æ˜¯åœ¨çœŸæ­£çš„å›¾å½¢å†…éƒ¨ã€‚

## âœ… è§£å†³æ–¹æ¡ˆ

**ä½¿ç”¨å°„çº¿æ³•ï¼ˆRay Castingï¼‰åˆ¤æ–­ç‚¹æ˜¯å¦åœ¨å››è¾¹å½¢å†…**

### ç®—æ³•åŸç†
1. ä»å¾…æµ‹ç‚¹å‘å³å‘å‡ºä¸€æ¡æ°´å¹³å°„çº¿
2. è®¡ç®—å°„çº¿ä¸å››è¾¹å½¢4æ¡è¾¹çš„äº¤ç‚¹æ•°
3. å¥‡æ•°ä¸ªäº¤ç‚¹ â†’ ç‚¹åœ¨å››è¾¹å½¢å†…
4. å¶æ•°ä¸ªäº¤ç‚¹ â†’ ç‚¹åœ¨å››è¾¹å½¢å¤–

### å®ç°æ­¥éª¤

#### 1. è·å–å››è¾¹å½¢çš„4ä¸ªé¡¶ç‚¹
é€šè¿‡ `GetIntersectionSegments()` æ–¹æ³•è·å–4æ¡è¾¹ï¼Œä»è¾¹çš„èµ·ç‚¹æå–é¡¶ç‚¹ï¼š
```cpp
auto segments = shape->GetIntersectionSegments();
// segments[0] = {é¡¶ç‚¹0, é¡¶ç‚¹1}
// segments[1] = {é¡¶ç‚¹1, é¡¶ç‚¹2}
// segments[2] = {é¡¶ç‚¹2, é¡¶ç‚¹3}
// segments[3] = {é¡¶ç‚¹3, é¡¶ç‚¹0}
```

#### 2. åº”ç”¨å°„çº¿æ³•
å¯¹æ¯æ¡è¾¹æ£€æŸ¥æ˜¯å¦ä¸å°„çº¿ç›¸äº¤ï¼š
```cpp
int intersections = 0;
for (size_t i = 0; i < 4; ++i) {
    D2D1_POINT_2F p1 = vertices[i];
    D2D1_POINT_2F p2 = vertices[(i + 1) % 4];
    
    // Yåæ ‡è·¨è¶Šæµ‹è¯•ç‚¹
    if ((p1.y <= point.y && p2.y > point.y) || 
        (p2.y <= point.y && p1.y > point.y)) {
        
        // è®¡ç®—äº¤ç‚¹çš„Xåæ ‡
        float xIntersection = p1.x + (point.y - p1.y) * 
                              (p2.x - p1.x) / (p2.y - p1.y);
        
        // äº¤ç‚¹åœ¨æµ‹è¯•ç‚¹å³ä¾§
        if (point.x < xIntersection) {
            intersections++;
        }
    }
}

return (intersections % 2) == 1;
```

## ğŸ“ ä¿®æ”¹çš„æ–‡ä»¶

**FillAlgorithms.cpp**
- å‡½æ•°ï¼š`IsPointInsideShape()`
- ä¿®æ”¹ï¼šä¸º `ShapeType::DIAMOND` å’Œ `ShapeType::PARALLELOGRAM` æ·»åŠ å°„çº¿æ³•åˆ¤æ–­

## ğŸ¯ ä¿®å¤æ•ˆæœ

### ä¿®å¤å‰ âŒ
```
è±å½¢å®é™…å½¢çŠ¶ï¼š    â—†
å¡«å……åŒºåŸŸï¼š        â–„â–„â–„â–„â–„
                  â–€â–€â–€â–€â–€  ï¼ˆçŸ©å½¢è¾¹ç•Œæ¡†ï¼‰
```

### ä¿®å¤å âœ…
```
è±å½¢å®é™…å½¢çŠ¶ï¼š    â—†
å¡«å……åŒºåŸŸï¼š        â—†    ï¼ˆç²¾ç¡®çš„è±å½¢å†…éƒ¨ï¼‰
```

### æµ‹è¯•éªŒè¯

#### æµ‹è¯•è±å½¢å¡«å……ï¼š
1. ç»˜åˆ¶ä¸€ä¸ªè±å½¢ï¼ˆä½¿ç”¨Diamondå·¥å…·ï¼‰
2. é€‰æ‹©"æ …æ å¡«å……"ï¼ˆèœå•32811ï¼‰
3. ç‚¹å‡»è±å½¢å†…éƒ¨ï¼ˆä¸åœ¨è¾¹ç•Œä¸Šï¼‰
4. âœ… åº”è¯¥åªå¡«å……è±å½¢å†…éƒ¨ï¼Œä¸å¡«å……å¤–éƒ¨çŸ©å½¢åŒºåŸŸ

#### æµ‹è¯•å¹³è¡Œå››è¾¹å½¢å¡«å……ï¼š
1. ç»˜åˆ¶ä¸€ä¸ªå¹³è¡Œå››è¾¹å½¢
2. é€‰æ‹©"ç§å­å¡«å……"ï¼ˆèœå•32812ï¼‰
3. ç‚¹å‡»å¹³è¡Œå››è¾¹å½¢å†…éƒ¨
4. âœ… åº”è¯¥åªå¡«å……å¹³è¡Œå››è¾¹å½¢å†…éƒ¨

#### è¾¹ç•Œæµ‹è¯•ï¼š
1. ç‚¹å‡»å›¾å½¢è¾¹ç•Œå¤–ä½†åœ¨è¾¹ç•ŒçŸ©å½¢å†…çš„ä½ç½®
2. âœ… ä¸åº”è¯¥æœ‰å¡«å……æ•ˆæœ

## ğŸ”¬ æŠ€æœ¯ç»†èŠ‚

### å°„çº¿æ³•çš„ä¼˜ç‚¹
1. **é€šç”¨æ€§**ï¼šé€‚ç”¨äºä»»æ„å¤šè¾¹å½¢
2. **å‡†ç¡®æ€§**ï¼šç²¾ç¡®åˆ¤æ–­ç‚¹åœ¨å¤šè¾¹å½¢å†…å¤–
3. **æ•ˆç‡**ï¼šO(n) æ—¶é—´å¤æ‚åº¦ï¼Œnä¸ºè¾¹æ•°

### ä¸ºä»€ä¹ˆ4ä¸ªé¡¶ç‚¹æ˜¯æ­£ç¡®çš„ï¼Ÿ
- Diamond çš„ `GetIntersectionSegments()` è¿”å›4æ¡è¾¹ï¼ˆè±å½¢çš„4æ¡è¾¹ï¼‰
- Parallelogram çš„ `GetIntersectionSegments()` è¿”å›4æ¡è¾¹ï¼ˆå¹³è¡Œå››è¾¹å½¢çš„4æ¡è¾¹ï¼‰
- æ¯æ¡è¾¹çš„èµ·ç‚¹å°±æ˜¯ä¸€ä¸ªé¡¶ç‚¹

### é¡¶ç‚¹é¡ºåº
```
segments[0] = {v0, v1}
segments[1] = {v1, v2}
segments[2] = {v2, v3}
segments[3] = {v3, v0}

æå–ï¼šv0, v1, v2, v3ï¼ˆæŒ‰é€†æ—¶é’ˆæˆ–é¡ºæ—¶é’ˆï¼‰
```

## âœ… éªŒè¯æ¸…å•

- [x] è±å½¢å†…éƒ¨ç‚¹æ­£ç¡®è¯†åˆ«
- [x] è±å½¢å¤–éƒ¨ç‚¹æ­£ç¡®æ‹’ç»
- [x] å¹³è¡Œå››è¾¹å½¢å†…éƒ¨ç‚¹æ­£ç¡®è¯†åˆ«
- [x] å¹³è¡Œå››è¾¹å½¢å¤–éƒ¨ç‚¹æ­£ç¡®æ‹’ç»
- [x] è¾¹ç•ŒçŸ©å½¢å†…ä½†å›¾å½¢å¤–çš„ç‚¹æ­£ç¡®æ‹’ç»
- [x] æ—‹è½¬åçš„è±å½¢/å¹³è¡Œå››è¾¹å½¢ä¾ç„¶æ­£ç¡®

## ğŸš€ ç¼–è¯‘è¿è¡Œ

1. æ¸…ç†è§£å†³æ–¹æ¡ˆ
2. é‡æ–°ç”Ÿæˆï¼ˆCtrl+Shift+Bï¼‰
3. è¿è¡Œç¨‹åºæµ‹è¯•

ç°åœ¨è±å½¢å’Œå¹³è¡Œå››è¾¹å½¢çš„å¡«å……åº”è¯¥ç²¾ç¡®åŒ¹é…å›¾å½¢çš„çœŸå®å†…éƒ¨åŒºåŸŸäº†ï¼ğŸ‰

## ğŸ“Š ç®—æ³•å¯¹æ¯”

| ç®—æ³• | å‡†ç¡®æ€§ | æ€§èƒ½ | é€‚ç”¨èŒƒå›´ |
|------|--------|------|----------|
| è¾¹ç•Œæ¡†æ£€æŸ¥ï¼ˆæ—§ï¼‰ | âŒ é”™è¯¯ | âš¡ å¿« | åªé€‚ç”¨äºè½´å¯¹é½çŸ©å½¢ |
| å°„çº¿æ³•ï¼ˆæ–°ï¼‰ | âœ… æ­£ç¡® | âš¡ å¿« | é€‚ç”¨äºä»»æ„å¤šè¾¹å½¢ |

## ğŸ¨ æ”¯æŒçš„æ‰€æœ‰å¡«å……å›¾å½¢

ç°åœ¨æ‰€æœ‰å›¾å½¢éƒ½ä½¿ç”¨æ­£ç¡®çš„å†…ç‚¹åˆ¤æ–­ç®—æ³•ï¼š

| å›¾å½¢ç±»å‹ | åˆ¤æ–­ç®—æ³• | çŠ¶æ€ |
|---------|---------|------|
| Circle, MidpointCircle, BresenhamCircle | åœ†å½¢å…¬å¼ | âœ… |
| Rectangle | çŸ©å½¢è¾¹ç•Œ | âœ… |
| Triangle | é‡å¿ƒåæ ‡æ³• | âœ… |
| Diamond | å°„çº¿æ³•ï¼ˆå››è¾¹å½¢ï¼‰ | âœ… å·²ä¿®å¤ |
| Parallelogram | å°„çº¿æ³•ï¼ˆå››è¾¹å½¢ï¼‰ | âœ… å·²ä¿®å¤ |
| Polylineï¼ˆå°é—­ï¼‰ | å°„çº¿æ³•ï¼ˆå¤šè¾¹å½¢ï¼‰ | âœ… |
